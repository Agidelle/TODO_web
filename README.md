# Планировщик задач (TODO-лист)

## Описание проекта

Этот веб-сервер реализует функциональность планировщика задач, который является аналогом TODO-листа. Проект создан для проверки и закрепления навыков по написанию веб-серверов, работе с REST API и базами данных.

Планировщик позволяет управлять задачами, каждая из которых содержит следующие параметры:
- **Дата дедлайна**: когда задача должна быть выполнена.
- **Заголовок**: краткое описание задачи.
- **Комментарий**: дополнительная информация о задаче.
- **Правило повторения** (опционально): задача может повторяться через определённый интервал или в заданные дни.

Если задача имеет правило повторения, то при её выполнении она автоматически переносится на следующую дату в соответствии с правилом. Обычные задачи (без правила повторения) после выполнения удаляются из списка.

## Функциональность

### Характеристики задач
- Задачи могут иметь следующие типы правил повторения:
  - Ежегодно.
  - Через определённое количество дней.
  - В определённые дни месяца.
  - В определённые дни недели.

### API операции
Сервер предоставляет следующие операции через REST API:
1. **Добавить задачу**  
   Создание новой задачи с указанием заголовка, комментария, даты дедлайна и (опционально) правила повторения.

2. **Получить список задач**  
   Получение списка всех задач с фильтрацией по дате или статусу.

3. **Удалить задачу**  
   Удаление задачи по её уникальному идентификатору.

4. **Получить параметры задачи**  
   Получение детальной информации о конкретной задаче.

5. **Изменить параметры задачи**  
   Обновление заголовка, комментария, даты дедлайна или правила повторения.

6. **Отметить задачу как выполненную**  
   Отмечает задачу как выполненную. Если задача имеет правило повторения, она переносится на следующую дату. Если задача обычная, она удаляется.

## Архитектура сервиса

### Структура проекта

- **cmd**
  - **app.go**: Инициализация приложения, запуск сервера и реализация graceful shutdown.

- **internal**
  - **api**
    - **api**: Обработчики HTTP-запросов (handlers).
    - **auth**:  Модуль аутентификации и middleware для проверки JWT-токенов.
  - **config**: Загрузка и управление конфигурацией приложения.
  - **domain**: Определение структур данных и интерфейсов, используемых в приложении.
  - **service**: Реализация бизнес-логики сервиса.
  - **storage**: Взаимодействие с базой данных SQLite.
  
### Особенности реализации
Интерфейс `domain.TaskRepository` разработан для обеспечения гибкости при подключении различных баз данных. Это позволяет интегрировать новые системы хранения данных без изменения бизнес-логики сервиса.\
Для локального тестирования поддерживается использование `.env` файла. При наличии переменных окружения они имеют приоритет над значениями из `.env`.\

### Принципы работы

- **Модульность**: Каждый компонент приложения (API, сервисы, хранилище) четко разделен на отдельные пакеты, что обеспечивает удобство поддержки и масштабирования.
- **Гибкость конфигурирования**: Поддержка как переменных окружения, так и `.env` файла позволяет легко адаптировать приложение под различные среды выполнения.
- **Расширяемость**: Архитектура спроектирована с учетом возможности замены компонентов (например, базы данных) без необходимости глобальных изменений в кодовой базе.
### Пример .env:
```
TODO_PORT=7540
TODO_DRIVER=sqlite
TODO_DBFILE=./scheduler.db
TODO_PASSWORD=password
TODO_JWTSECRET=secret
```

### Стек технологий
- **Язык программирования**: Go
- **Веб-фреймворк**: Chi
- **База данных**: SQLite
- **API формат**: JSON

## Технические детали

### 


### Пример запросов для тестирования

Все задания со звёздочкой были реализованы.
В тестах включены все дополнительные настройки.

### Проверка работоспособности в Docker
Конфигурация:\
Порт: 7540\
endpoint: http://localhost:7540/ \
**curl** *предустановлен*\
Пример команды для сборки Docker-образа:\
`docker build -t todo-web:1.0 .`\
Сервис запускается автоматически при старте контейнера.

#### Получить токен авторизации
```bash
curl -X POST http://localhost:7540/api/signin \
-d '{"password":"<TODO_PASSWORD>"}'
```
#### Добавить задачу
```bash
curl -X POST http://localhost:7540/api/task \
-H "Content-Type: application/json" \
-H "Cookie: token=<token>" \
-d '{
    "date": "20250501",
    "title": "Подвести итог",
    "comment": "Мой комментарий",
    "repeat": "d 5"
}'
```
#### Получить все задачи
```bash
curl -X GET "http://localhost:7540/api/tasks" \
-H "Cookie: token=<token>"
```
